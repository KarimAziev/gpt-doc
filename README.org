#+OPTIONS: ^:nil tags:nil

* About
Document Elisp code using OpenAI's GPT language model according to Emacs' style requirements.

[[./gpt-doc-demo.gif][./gpt-doc-demo.gif]]

* Table of Contents                                       :TOC_2_gh:QUOTE:
#+BEGIN_QUOTE
- [[#about][About]]
- [[#requirements][Requirements]]
- [[#installation][Installation]]
  - [[#with-use-package-and-straightel][With use-package and straight.el]]
  - [[#manual-installation][Manual installation]]
- [[#setup][Setup]]
- [[#usage][Usage]]
- [[#customization][Customization]]
#+END_QUOTE

* Requirements

| Name           | Version |
|----------------+---------|
| Emacs          |    27.1 |
| [[https://platform.openai.com/account/api-keys][OpenAI API Key]] |         |


* Installation

To use =gpt-doc.el=, make sure you have Emacs version 27.1 or later installed.

** With use-package and straight.el
#+begin_src elisp :eval no
(use-package gpt-doc
  :straight (gpt-doc
             :repo "KarimAziev/gpt-doc"
             :type git
             :host github)
  :commands (gpt-doc-document-current-function))
#+end_src

** Manual installation

Download the source code and put it wherever you like, e.g. into =~/.emacs.d/gpt-doc/=

#+begin_src shell :eval no
git clone https://github.com/KarimAziev/gpt-doc.git ~/.emacs.d/gpt-doc/
#+end_src

Add the downloaded directory to the load path:

#+begin_src elisp :eval no
(add-to-list 'load-path "~/.emacs.d/gpt-doc/")
(require 'gpt-doc)
#+end_src

* Setup

Make sure that you have an [[https://platform.openai.com/account/api-keys][OpenAI API key]] before using the library.

You can choose from several options to use it:

1. Assign the API key to the =gpt-doc-api-key= variable:
#+begin_src emacs-lisp
(setq gpt-doc-api-key "YOUR_API_KEY_TOKEN")
#+end_src

2. Add the following entry to your auth sources file (typically =~/.authinfo.gpg= or =~/.authinfo=):
#+begin_example
machine api.openai.com login apikey password YOUR_API_KEY_TOKEN
#+end_example

3. Assign a custom function that returns the API key to =gpt-doc-api-key=:
  #+begin_src emacs-lisp
(defun my-gpt-get-api-key ()
  "Return api key for gpt."
  (let ((api-key "YOUR_API_KEY_TOKEN"))
    api-key))

(setq gpt-doc-api-key #'my-gpt-get-api-key)
#+end_src

* Usage

Run ~M-x gpt-doc-document-current-function~ inside or at the start of the function/macro definition.

The generated documentation will be inserted into the correct place for documentation.

* Customization

*** ~gpt-doc-api-key~
An OpenAI API key. It can be a string or a function that returns the API key.
*** ~gpt-doc-gpt-url~
The URL queried by GPT. The default URL is https://api.openai.com/v1/chat/completions.
*** ~gpt-doc-no-args-directive~
System prompt (directive) for ChatGPT to document Elisp code without arguments. These are system instructions sent at the beginning of each request to ChatGPT.
*** ~gpt-doc-with-args-directive~
System prompt (directive) for ChatGPT to document Elisp code with arguments. These are system instructions sent at the beginning of each request to ChatGPT.
*** ~gpt-doc-gpt-model~
API Model for OpenAI. The default model is "gpt-3.5-turbo".
*** ~gpt-doc-gpt-temperature~
The "temperature" of the GPT response, controlling the randomness. The value should be between 0.0 and 2.0, with 2.0 being the most random.